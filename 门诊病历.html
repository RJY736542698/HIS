<!DOCTYPE html>
<html>
  <head>
    <title>门诊病历</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <link href="门诊病历css/resources/css/jquery-ui-themes.css" type="text/css" rel="stylesheet"/>
    <link href="门诊病历css/resources/css/axure_rp_page.css" type="text/css" rel="stylesheet"/>
    <link href="门诊病历css/data/styles.css" type="text/css" rel="stylesheet"/>
    <link href="门诊病历css/files/门诊病历/styles.css" type="text/css" rel="stylesheet"/>
    <script src="门诊病历css/resources/scripts/jquery-1.7.1.min.js"></script>
    <script src="门诊病历css/resources/scripts/jquery-ui-1.8.10.custom.min.js"></script>
    <script src="门诊病历css/resources/scripts/prototypePre.js"></script>
    <script src="门诊病历css/data/document.js"></script>
    <script src="门诊病历css/resources/scripts/prototypePost.js"></script>
    <script src="门诊病历css/files/门诊病历/data.js"></script>
    <script type="text/javascript">
      $axure.utils.getTransparentGifPath = function() { return 'resources/images/transparent.gif'; };
      $axure.utils.getOtherPath = function() { return 'resources/Other.html'; };
      $axure.utils.getReloadPath = function() { return 'resources/reload.html'; };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    
    <style type="text/css">
      .mytable tr:hover{
        background-color: rgb(220, 243, 255);
        cursor: pointer;
      }
      a{
          text-decoration: none;
        }
        a:hover{
          color: blue;
          cursor: pointer;
        }
        #aaa{
          padding-right: 600px; 
          height: 31px;
          color: #666666; 
          font-family:'华文中宋';
        }
        #u0_div a:hover{
          color: blue;
          cursor: pointer;
        }
      
    </style>
  </head>
  <body>
    <div id="base" class="">

      <!-- Unnamed (矩形) -->
      <div id="u0" class="ax_default box_3">
        <div id="u0_div" class="">
          <div style="margin: auto; margin-top: 6px;">
            <a id="aaa" href="看诊结果.html">看诊结果</a>
          </div>
          
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u1" class="ax_default box_2">
        <div id="u1_div" class=""></div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u2" class="ax_default link_button">
        <div id="u2_div" class=""></div>
        <div id="u2_text" class="text ">
          <p><a>门诊病历</a></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u3" class="ax_default link_button">
        <div id="u3_div" class=""></div>
        <div id="u3_text" class="text ">
          <p><a href="检查申请.html">检查申请</a></p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u4" class="ax_default link_button">
        <div id="u4_div" class=""></div>
        <div id="u4_text" class="text ">
          <p><a href="检验申请.html">检验申请</a>
          
          </p>
        </div>
      </div>

      <!-- Unnamed (矩形) -->
      <div id="u5" class="ax_default link_button">
        <div id="u5_div" class=""></div>
        <div id="u5_text" class="text ">
          <p><a href="医生确诊.html">医生确诊</a>
            <!-- <a >看诊结果</a> -->
          </p>
          <!-- <p><a style="width: 56px; height: 20px; margin: auto; padding: auto; padding-left: 80px;">看诊结果</a></p> -->
        </div>
         <!-- <a style="width: 56px; height: 20px; margin: auto; padding: auto; padding-left: 80px;">看诊结果</a> -->
      </div>
      <!-- Unnamed (矩形) -->
      <div id="u6" class="ax_default label">
        <div id="u6_div" class=""></div>
        <div id="u6_text" class="text ">
          <p><span>未看诊患者信息</span></p>
        </div>
      </div>
      <div style="width: 100%;height:100%;">
        <table width="100%" border="1" cellpadding="8" cellspacing="0" 
        style="margin: auto; margin-top: 90px; margin-left: 20px; font-family:'宋体';" class="mytable">
          <tr>
              <th>患者编号</th>
              <th>姓名</th>
              <th>性别</th>
              <th>出生日期</th>
              <th>身份证号</th>
              <th>挂号级别</th>
              <th>挂号日期</th>
              <th>挂号费用</th>
              <th>看诊日期</th>
              <th>看诊科室</th>
              <th>看诊医生</th>
              <th>是否已诊</th>
              <th>是否需要病历本</th>
              <th>状态</th>
          </tr>
          <tr v-for="item in registers" @click="huanzhexinxi(item.id)">
            <td >{{item.caseNumber}}</td>
            <td>{{item.realName}}</td>
            <td>{{item.gender}}</td>
            <td>{{item.birthdate}}</td>
            <td>{{item.cardNumber}}</td>
            <td>{{item.registLevel.registName}}</td>
            <td>{{item.registerDate}}</td>
            <td>{{item.registMoney}}</td>
            <td>{{item.visitDate}}</td>
            <td>{{item.department.deptName}}</td>
            <td>{{item.employee.realname}}</td>
            <td>{{item.visitState|str}}</td>
            <td>{{item.isBook}}</td>
            <td>{{item.visitState|visitstate}}</td>
          </tr>
          </table>
      </div>
    </div>
  </body>
  <script>

    let vm= new Vue({
      el:'#base',
      data:{
        
        registers:[],
        register:{
          employee:{
            realname:''
          },
          department:{
            deptName:''
          },
          registLevel:{
            registName:''
          }
        }
      },
      methods:{
        huanzhexinxi(id){
          axios.post('http://localhost:8092/register-queryId',{
            id:id
          })
          .then(response=>{
            console.log(response.data);
            this.register=response.data;
            // window.location.href="./患者信息填写病历.html?register="+this.register
            window.location.href="./患者信息填写病历.html?id="+this.register.id
          })
          .catch(function(err){
            console.log(err);
           })
          axios.post('http://localhost:8092/register-updateVisitState',{
            id:id
          })
          .then(response=>{
            console.log(response.data);
          })
          .catch(function(err){
            console.log(err);
           })
        } 
      },
      created(){
        console.log(JSON.parse(sessionStorage.loginUser).realname);
        var doctorname = JSON.parse(sessionStorage.loginUser).realname;
        axios.post('http://localhost:8092/register-Not-Visit',{
          realname:doctorname
        }
        ).then(response=>{
          console.log(response.data);
          this.registers=response.data;
          console.log(this.registers)
        }).catch(function(err){
          console.log(err);
        })
      },
      filters:{
      str(value){
        if(value==1 |value==4){
          return "否"
        }
        if(value==2 |value==3){
          return "是"
        }
      },
      visitstate(value){
        switch(value){
          case 1:
            return "已挂号";
            break;
          case 2:
            return "医生接诊";
            break;
          case 3:
            return "看诊结束";
            break;
          case 4:
            return "已退号";
            break;
          default:
            return "";
            break;
        }
      }
    },
    })
  </script>
</html>
